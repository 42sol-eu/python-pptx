

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pptx.presentation &mdash; python-pptx 0.1.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="python-pptx 0.1.0 documentation" href="../../index.html" />
    <link rel="up" title="pptx" href="../pptx.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">python-pptx 0.1.0 documentation</a> &raquo;</li>
          <li><a href="../index.html" >Module code</a> &raquo;</li>
          <li><a href="../pptx.html" accesskey="U">pptx</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for pptx.presentation</h1><div class="highlight"><pre>
<span class="c"># -*- coding: utf-8 -*-</span>
<span class="c">#</span>
<span class="c"># presentation.py</span>
<span class="c">#</span>
<span class="c"># Copyright (C) 2012, 2013 Steve Canny scanny@cisco.com</span>
<span class="c">#</span>
<span class="c"># This module is part of python-pptx and is released under</span>
<span class="c"># the MIT License: http://www.opensource.org/licenses/mit-license.php</span>

<span class="sd">&#39;&#39;&#39;API classes for dealing with presentations and other objects one typically</span>
<span class="sd">encounters as an end-user of the PowerPoint user interface.&#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">zipfile</span>

<span class="kn">from</span> <span class="nn">StringIO</span>   <span class="kn">import</span> <span class="n">StringIO</span>
<span class="kn">from</span> <span class="nn">lxml</span>       <span class="kn">import</span> <span class="n">etree</span>
<span class="kn">from</span> <span class="nn">lxml.etree</span> <span class="kn">import</span> <span class="n">ElementTree</span><span class="p">,</span> <span class="n">Element</span><span class="p">,</span> <span class="n">SubElement</span>

<span class="kn">from</span> <span class="nn">pptx</span>           <span class="kn">import</span> <span class="n">spec</span>
<span class="kn">from</span> <span class="nn">pptx</span>           <span class="kn">import</span> <span class="n">util</span>
<span class="kn">from</span> <span class="nn">pptx.packaging</span> <span class="kn">import</span> <span class="n">Package</span><span class="p">,</span> <span class="n">TemplatePackage</span>
<span class="kn">from</span> <span class="nn">pptx.spec</span>      <span class="kn">import</span> <span class="n">qname</span>


<span class="c"># ============================================================================</span>
<span class="c"># Class catalog</span>
<span class="c"># ============================================================================</span>

<span class="c"># API Classes</span>
<span class="c"># ----------------------------------------------------------------------------</span>
<span class="c"># Presentation</span>
<span class="c"># Template</span>

<span class="c"># Base Classes</span>
<span class="c"># ----------------------------------------------------------------------------</span>
<span class="c"># Shape</span>
<span class="c">#REFACTOR: See if there&#39;s an opportunity for Part, perhaps Master, also</span>
<span class="c">#          Collection.</span>

<span class="c"># Presentation Parts</span>
<span class="c"># ----------------------------------------------------------------------------</span>
<span class="c"># Slide</span>
<span class="c"># Slides</span>

<span class="c"># Slide Elements</span>
<span class="c"># ----------------------------------------------------------------------------</span>
<span class="c"># Shapes</span>
<span class="c">#REFACTOR: This code needs to find a home in another slide element</span>
<span class="c"># # PlaceholderText</span>

<span class="c"># Template Part Collections</span>
<span class="c"># ----------------------------------------------------------------------------</span>
<span class="c"># TemplatePartCollection</span>
<span class="c"># Images</span>
<span class="c"># SlideLayouts</span>
<span class="c"># SlideMasters</span>
<span class="c"># Themes</span>

<span class="c"># Template Parts</span>
<span class="c"># ----------------------------------------------------------------------------</span>
<span class="c"># TemplatePart</span>
<span class="c"># HandoutMaster</span>
<span class="c"># Image</span>
<span class="c"># NotesMaster</span>
<span class="c"># PresProps</span>
<span class="c"># SlideLayout</span>
<span class="c"># SlideMaster</span>
<span class="c"># TableStyles</span>
<span class="c"># Theme</span>
<span class="c"># ViewProps</span>

<span class="c">#TODO: To be implemented</span>
<span class="c"># ----------------------------------------------------------------------------</span>
<span class="c"># HandoutMaster</span>
<span class="c"># NotesMaster</span>
<span class="c"># SlideShow</span>


<span class="c"># ============================================================================</span>
<span class="c"># Presentation</span>
<span class="c"># ============================================================================</span>
<span class="c"># Top level class in object model, represents the contents of the /ppt</span>
<span class="c"># directory of a .pptx file.</span>
<span class="c">#     I&#39;m thinking there&#39;s a higher-level construct, perhaps an OfficeDocument</span>
<span class="c"># class that holds things like the document properties and thumbnail image.</span>
<span class="c"># ============================================================================</span>
<span class="c"># CAUTION: Currently __applytemplate assumes all the presentation</span>
<span class="c"># collections are empty, so it should only be called from the __init__()</span>
<span class="c"># method. It might make sense later to add it to the API and make it smart</span>
<span class="c"># enough to be applied to a presentation that already has some content in it,</span>
<span class="c"># but that&#39;s for a future effort.</span>
<span class="c"># ============================================================================</span>

<div class="viewcode-block" id="Presentation"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.Presentation">[docs]</a><span class="k">class</span> <span class="nc">Presentation</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">templatedir</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">templatedir</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__normalizedtemplatedir</span><span class="p">(</span><span class="n">templatedir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_element</span>     <span class="o">=</span> <span class="bp">None</span>
        <span class="c"># initialize collections</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">images</span>       <span class="o">=</span> <span class="n">Images</span>       <span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">themes</span>       <span class="o">=</span> <span class="n">Themes</span>       <span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slidemasters</span> <span class="o">=</span> <span class="n">SlideMasters</span> <span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slidelayouts</span> <span class="o">=</span> <span class="n">SlideLayouts</span> <span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slides</span>       <span class="o">=</span> <span class="n">Slides</span>       <span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="c"># apply template</span>
        <span class="n">template</span> <span class="o">=</span> <span class="n">Template</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">templatedir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__applytemplate</span><span class="p">(</span><span class="n">template</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">__applytemplate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">template</span><span class="p">):</span>
        <span class="c"># add parts</span>
<span class="c">#REFACTOR: Seems like the template&#39;s part collections should be added directly</span>
<span class="c">#          rather than reconstructing them from scratch. Maybe even do it</span>
<span class="c">#          in __init__() and then initializing the presentation-specific</span>
<span class="c">#          collections like slides. E.g.:</span>
<span class="c">#          self.images = template.images if template.images else ImageCollection()</span>
        <span class="k">for</span> <span class="n">image</span>       <span class="ow">in</span> <span class="n">template</span><span class="o">.</span><span class="n">images</span>       <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">images</span>       <span class="o">.</span><span class="n">additem</span><span class="p">(</span><span class="n">image</span>       <span class="o">.</span><span class="n">path</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">theme</span>       <span class="ow">in</span> <span class="n">template</span><span class="o">.</span><span class="n">themes</span>       <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">themes</span>       <span class="o">.</span><span class="n">additem</span><span class="p">(</span><span class="n">theme</span>       <span class="o">.</span><span class="n">path</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">slidemaster</span> <span class="ow">in</span> <span class="n">template</span><span class="o">.</span><span class="n">slidemasters</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">slidemasters</span> <span class="o">.</span><span class="n">additem</span><span class="p">(</span><span class="n">slidemaster</span> <span class="o">.</span><span class="n">path</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">slidelayout</span> <span class="ow">in</span> <span class="n">template</span><span class="o">.</span><span class="n">slidelayouts</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">slidelayouts</span> <span class="o">.</span><span class="n">additem</span><span class="p">(</span><span class="n">slidelayout</span> <span class="o">.</span><span class="n">path</span><span class="p">)</span>
        <span class="c"># set singleton parts</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element</span>       <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">element</span>      <span class="c"># this part is different because it&#39;s the presentation root item rather than a part that belongs to the presentation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">presprops</span>     <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">presprops</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tablestyles</span>   <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">tablestyles</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">viewprops</span>     <span class="o">=</span> <span class="n">template</span><span class="o">.</span><span class="n">viewprops</span>
<span class="c">#TECHDEBT: Need to make this work when either of these two files don&#39;t exist in the template</span>
        <span class="c"># self.handoutmaster = template.handoutmaster</span>
        <span class="c"># self.notesmaster   = template.viewprops</span>
        
        <span class="c"># add relationships</span>
        <span class="k">for</span> <span class="n">relationship</span> <span class="ow">in</span> <span class="n">template</span><span class="o">.</span><span class="n">relationships</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__applyrelationship</span><span class="p">(</span><span class="n">relationship</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">__applyrelationship</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">relationship</span><span class="p">):</span>
        <span class="c"># print &#39;Relationship %s  ==&gt;  %s&#39; % (relationship.fromtype, relationship.totype)</span>
        
        <span class="n">collections</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;image&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">images</span><span class="p">,</span> <span class="s">&#39;slideLayout&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">slidelayouts</span><span class="p">,</span> <span class="s">&#39;slideMaster&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">slidemasters</span><span class="p">,</span> <span class="s">&#39;theme&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">themes</span><span class="p">}</span>
        <span class="n">fromtype</span>    <span class="o">=</span> <span class="n">relationship</span><span class="o">.</span><span class="n">fromtype</span>
        <span class="n">frompath</span>    <span class="o">=</span> <span class="n">relationship</span><span class="o">.</span><span class="n">frompath</span>
        <span class="n">fromitem</span>    <span class="o">=</span> <span class="n">collections</span><span class="p">[</span><span class="n">fromtype</span><span class="p">]</span><span class="o">.</span><span class="n">getitem</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">frompath</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">fromitem</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;&quot;&quot;Lookup of </span><span class="si">%s</span><span class="s"> failed on relationship </span><span class="si">%s</span><span class="s"> ==&gt; </span><span class="si">%s</span><span class="s">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fromtype</span><span class="p">,</span> <span class="n">fromtype</span><span class="p">,</span> <span class="n">totype</span><span class="p">))</span>   <span class="c"># remove after debugging</span>
        <span class="n">totype</span>      <span class="o">=</span> <span class="n">relationship</span><span class="o">.</span><span class="n">totype</span>
        <span class="n">topath</span>      <span class="o">=</span> <span class="n">relationship</span><span class="o">.</span><span class="n">topath</span>
        <span class="n">toitem</span>      <span class="o">=</span> <span class="n">collections</span><span class="p">[</span><span class="n">totype</span><span class="p">]</span><span class="o">.</span><span class="n">getitem</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">topath</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">toitem</span><span class="p">:</span> <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;&quot;&quot;Lookup of </span><span class="si">%s</span><span class="s"> failed on relationship </span><span class="si">%s</span><span class="s"> ==&gt; </span><span class="si">%s</span><span class="s">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">totype</span><span class="p">,</span> <span class="n">fromtype</span><span class="p">,</span> <span class="n">totype</span><span class="p">))</span>       <span class="c"># remove after debugging</span>
        
        <span class="k">if</span> <span class="n">fromtype</span> <span class="o">==</span> <span class="s">&#39;slideMaster&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">totype</span> <span class="o">==</span> <span class="s">&#39;slideLayout&#39;</span><span class="p">:</span>
                <span class="n">fromitem</span><span class="o">.</span><span class="n">slidelayouts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">toitem</span><span class="p">)</span> <span class="c"># slideLayout provides backreference</span>
            <span class="k">elif</span> <span class="n">totype</span> <span class="o">==</span> <span class="s">&#39;theme&#39;</span><span class="p">:</span>
                <span class="n">fromitem</span><span class="o">.</span><span class="n">theme</span> <span class="o">=</span> <span class="n">toitem</span>              <span class="c"># no backreference required</span>
            <span class="k">elif</span> <span class="n">totype</span> <span class="o">==</span> <span class="s">&#39;image&#39;</span><span class="p">:</span>
                <span class="n">fromitem</span><span class="o">.</span><span class="n">images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">toitem</span><span class="p">)</span>       <span class="c"># add image reference to slideMaster</span>
                <span class="n">toitem</span><span class="o">.</span><span class="n">slidemasters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fromitem</span><span class="p">)</span> <span class="c"># add backreference</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s">&quot;&quot;&quot;Relationship from </span><span class="si">%s</span><span class="s"> to </span><span class="si">%s</span><span class="s"> not implemented.&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fromtype</span><span class="p">,</span> <span class="n">totype</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">fromtype</span> <span class="o">==</span> <span class="s">&#39;slideLayout&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">totype</span> <span class="o">==</span> <span class="s">&#39;slideMaster&#39;</span><span class="p">:</span>
                <span class="n">fromitem</span><span class="o">.</span><span class="n">slidemaster</span> <span class="o">=</span> <span class="n">toitem</span>        <span class="c"># slideMaster provides backreference</span>
            <span class="k">elif</span> <span class="n">totype</span> <span class="o">==</span> <span class="s">&#39;image&#39;</span><span class="p">:</span>
                <span class="n">fromitem</span><span class="o">.</span><span class="n">images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">toitem</span><span class="p">)</span>       <span class="c"># add image reference to slideLayout</span>
                <span class="n">toitem</span><span class="o">.</span><span class="n">slidelayouts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fromitem</span><span class="p">)</span> <span class="c"># and add backreference from image</span>
            <span class="c"># elif totype == &#39;theme&#39;:</span>
            <span class="c">#     fromitem.theme = toitem              # no backreference required</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s">&quot;&quot;&quot;Relationship from </span><span class="si">%s</span><span class="s"> to </span><span class="si">%s</span><span class="s"> not implemented.&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fromtype</span><span class="p">,</span> <span class="n">totype</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">fromtype</span> <span class="o">==</span> <span class="s">&#39;theme&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">totype</span> <span class="o">==</span> <span class="s">&#39;image&#39;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s">&quot;&quot;&quot;Relationship from </span><span class="si">%s</span><span class="s"> to </span><span class="si">%s</span><span class="s"> not implemented.&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fromtype</span><span class="p">,</span> <span class="n">totype</span><span class="p">))</span>
                <span class="c"># lookup the image in question</span>
                <span class="c"># add a reference to the image to the theme</span>
                <span class="c"># add a reference to the theme to the image</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s">&quot;&quot;&quot;Relationship from </span><span class="si">%s</span><span class="s"> to </span><span class="si">%s</span><span class="s"> not implemented.&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fromtype</span><span class="p">,</span> <span class="n">totype</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s">&quot;&quot;&quot;Relationship from </span><span class="si">%s</span><span class="s"> to </span><span class="si">%s</span><span class="s"> not implemented.&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">fromtype</span><span class="p">,</span> <span class="n">totype</span><span class="p">))</span>
            
        <span class="c"># print &quot;collections[fromtype] is class &#39;%s&#39;&quot; % collections[fromtype].__class__.__name__</span>
        <span class="c"># print &quot;fromitem is class &#39;%s&#39;&quot; % fromitem.__class__.__name__</span>
        <span class="c"># print &#39;Presentation contains %d slidemaster(s).&#39; % len(self.slidemasters)</span>
        <span class="c"># print</span>
    
    <span class="k">def</span> <span class="nf">__normalizedtemplatedir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">templatedir</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">templatedir</span><span class="p">:</span>  <span class="c"># if templatedir is not provided, the default template is used</span>
            <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">),</span><span class="s">&#39;pptx_template&#39;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">templatedir</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">templatedir</span><span class="p">)</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">element</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rId_iter</span>     <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">intsequence</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">presentation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_element</span>  <span class="c"># NOTE: this is presentation element, not presentation instance</span>
        
        <span class="c"># rewrite the sldMasterIdLst subelement ______________________________</span>
        <span class="n">sldMasterId_iter</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">intsequence</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">2147483660</span><span class="p">)</span>   <span class="c"># This starting number is a bit of a hack based on sldMasterId values found in files saved by PowerPoint</span>
        
        <span class="c"># create the new sldMasterIdLst element</span>
        <span class="n">sldMasterIdLst</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="n">qname</span><span class="p">(</span><span class="s">&#39;p&#39;</span><span class="p">,</span><span class="s">&#39;sldMasterIdLst&#39;</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">slidemaster</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">slidemasters</span><span class="p">:</span>
            <span class="nb">id</span>  <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sldMasterId_iter</span><span class="o">.</span><span class="n">next</span><span class="p">())</span>
            <span class="n">rId</span> <span class="o">=</span> <span class="s">&#39;rId</span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">rId_iter</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
            <span class="n">sldMasterId</span> <span class="o">=</span> <span class="n">SubElement</span><span class="p">(</span><span class="n">sldMasterIdLst</span><span class="p">,</span> <span class="n">qname</span><span class="p">(</span><span class="s">&#39;p&#39;</span><span class="p">,</span><span class="s">&#39;sldMasterId&#39;</span><span class="p">))</span>
            <span class="n">sldMasterId</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>
            <span class="n">sldMasterId</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">qname</span><span class="p">(</span><span class="s">&#39;r&#39;</span><span class="p">,</span><span class="s">&#39;id&#39;</span><span class="p">),</span> <span class="n">rId</span><span class="p">)</span>
            <span class="n">sldMasterIdLst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sldMasterId</span><span class="p">)</span>
        
        <span class="c"># get the old sldMasterIdLst element</span>
        <span class="n">old_sldMasterIdLst</span> <span class="o">=</span> <span class="n">presentation</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">qname</span><span class="p">(</span><span class="s">&#39;p&#39;</span><span class="p">,</span><span class="s">&#39;sldMasterIdLst&#39;</span><span class="p">))</span>
        <span class="c"># put new sldMasterIdLst element in place</span>
        <span class="k">if</span> <span class="n">old_sldMasterIdLst</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">presentation</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sldMasterIdLst</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">presentation</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">old_sldMasterIdLst</span><span class="p">,</span> <span class="n">sldMasterIdLst</span><span class="p">)</span>
        
        <span class="c"># rewrite the sldIdLst subelement ____________________________________</span>
        <span class="n">sldId_iter</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">intsequence</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>   <span class="c"># This starting number is also based on observed values in PowerPoint files, no idea where it comes from.</span>
        
        <span class="c"># create the new sldIdLst element</span>
        <span class="n">sldIdLst</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="n">qname</span><span class="p">(</span><span class="s">&#39;p&#39;</span><span class="p">,</span><span class="s">&#39;sldIdLst&#39;</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">slide</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">slides</span><span class="p">:</span>
            <span class="nb">id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sldId_iter</span><span class="o">.</span><span class="n">next</span><span class="p">())</span>
            <span class="n">rId</span> <span class="o">=</span> <span class="s">&#39;rId</span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">rId_iter</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
            <span class="n">sldId</span> <span class="o">=</span> <span class="n">SubElement</span><span class="p">(</span><span class="n">sldIdLst</span><span class="p">,</span> <span class="n">qname</span><span class="p">(</span><span class="s">&#39;p&#39;</span><span class="p">,</span><span class="s">&#39;sldId&#39;</span><span class="p">))</span>
            <span class="n">sldId</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>
            <span class="n">sldId</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">qname</span><span class="p">(</span><span class="s">&#39;r&#39;</span><span class="p">,</span><span class="s">&#39;id&#39;</span><span class="p">),</span> <span class="n">rId</span><span class="p">)</span>
            <span class="n">sldIdLst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sldId</span><span class="p">)</span>
        
        <span class="c"># get the old sldIdLst element</span>
        <span class="n">old_sldIdLst</span> <span class="o">=</span> <span class="n">presentation</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">qname</span><span class="p">(</span><span class="s">&#39;p&#39;</span><span class="p">,</span><span class="s">&#39;sldIdLst&#39;</span><span class="p">))</span>
        <span class="c"># put new sldIdLst element in place</span>
        <span class="k">if</span> <span class="n">old_sldIdLst</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c">#TECHDEBT: Won&#39;t need these next three lines once notesMasters and handoutMasters support is added</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">presentation</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">qname</span><span class="p">(</span><span class="s">&#39;p&#39;</span><span class="p">,</span><span class="s">&#39;notesMasterIdLst&#39;</span>  <span class="p">))</span> <span class="p">:</span> <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">presentation</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">qname</span><span class="p">(</span><span class="s">&#39;p&#39;</span><span class="p">,</span><span class="s">&#39;handoutMasterIdLst&#39;</span><span class="p">))</span> <span class="p">:</span> <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">presentation</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">sldIdLst</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">presentation</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">old_sldIdLst</span><span class="p">,</span> <span class="n">sldIdLst</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_element</span>
        
    
    <span class="nd">@element.setter</span>
<div class="viewcode-block" id="Presentation.element"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.Presentation.element">[docs]</a>    <span class="k">def</span> <span class="nf">element</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_element</span> <span class="o">=</span> <span class="n">element</span>
    </div>
<div class="viewcode-block" id="Presentation.save"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.Presentation.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="n">Package</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    


<span class="c"># ============================================================================</span>
<span class="c"># Template</span>
<span class="c"># ============================================================================</span>
<span class="c"># Assemble a presentation that contains only template parts (essentially a</span>
<span class="c"># presentation without any slides or slide sub-parts like notesSlides or</span>
<span class="c"># comments) from the unzipped presentation package in the specified directory.</span>
<span class="c"># ============================================================================</span>
<span class="c"># DEVNOTE: This is a bit overkill just for applying a template to a new</span>
<span class="c"># presentation, but I&#39;m thinking maybe later features will work on templates</span>
<span class="c"># as a first-class citizen, so happy to leave this implemented this way for</span>
<span class="c"># the sake of future enhancement opportunities.</span>
<span class="c"># ============================================================================</span>
</div></div>
<div class="viewcode-block" id="Template"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.Template">[docs]</a><span class="k">class</span> <span class="nc">Template</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">templatedir</span><span class="p">):</span>
        <span class="c"># initialize collections</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">images</span>       <span class="o">=</span> <span class="n">Images</span>       <span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">themes</span>       <span class="o">=</span> <span class="n">Themes</span>       <span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slidemasters</span> <span class="o">=</span> <span class="n">SlideMasters</span> <span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slidelayouts</span> <span class="o">=</span> <span class="n">SlideLayouts</span> <span class="p">()</span>
        <span class="c"># load template files from templatedir</span>
        <span class="n">templatepackage</span> <span class="o">=</span> <span class="n">TemplatePackage</span><span class="p">(</span><span class="n">templatedir</span><span class="p">)</span>
        <span class="n">templatefiles</span> <span class="o">=</span> <span class="n">templatepackage</span><span class="o">.</span><span class="n">templatefiles</span>
        <span class="k">for</span> <span class="n">imagefile</span>       <span class="ow">in</span> <span class="n">templatefiles</span><span class="o">.</span><span class="n">imagefiles</span>       <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">images</span>       <span class="o">.</span><span class="n">additem</span><span class="p">(</span><span class="n">imagefile</span>       <span class="o">.</span><span class="n">path</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">themefile</span>       <span class="ow">in</span> <span class="n">templatefiles</span><span class="o">.</span><span class="n">themefiles</span>       <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">themes</span>       <span class="o">.</span><span class="n">additem</span><span class="p">(</span><span class="n">themefile</span>       <span class="o">.</span><span class="n">path</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">slidemasterfile</span> <span class="ow">in</span> <span class="n">templatefiles</span><span class="o">.</span><span class="n">slidemasterfiles</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">slidemasters</span> <span class="o">.</span><span class="n">additem</span><span class="p">(</span><span class="n">slidemasterfile</span> <span class="o">.</span><span class="n">path</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">slidelayoutfile</span> <span class="ow">in</span> <span class="n">templatefiles</span><span class="o">.</span><span class="n">slidelayoutfiles</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">slidelayouts</span> <span class="o">.</span><span class="n">additem</span><span class="p">(</span><span class="n">slidelayoutfile</span> <span class="o">.</span><span class="n">path</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">presprops</span>     <span class="o">=</span> <span class="n">PresProps</span>     <span class="p">(</span><span class="n">templatefiles</span><span class="o">.</span><span class="n">prespropsfile</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tablestyles</span>   <span class="o">=</span> <span class="n">TableStyles</span>   <span class="p">(</span><span class="n">templatefiles</span><span class="o">.</span><span class="n">tablestylesfile</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">viewprops</span>     <span class="o">=</span> <span class="n">ViewProps</span>     <span class="p">(</span><span class="n">templatefiles</span><span class="o">.</span><span class="n">viewpropsfile</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
<span class="c">#TECHDEBT: Need to make these two files optional</span>
        <span class="c"># self.handoutmaster = HandoutMaster (templatefiles.handoutmasterfile.path)</span>
        <span class="c"># self.notesmaster   = NotesMaster   (templatefiles.viewpropsfile.path)</span>
        
        <span class="c"># load presentation.xml into element property</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">XMLParser</span><span class="p">(</span><span class="n">remove_blank_text</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>  <span class="c"># need to remove indentation whitespace so pretty_print will work later</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">templatefiles</span><span class="o">.</span><span class="n">presentationfile</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">parser</span><span class="p">)</span><span class="o">.</span><span class="n">getroot</span><span class="p">()</span>
        
        <span class="c"># load package relationships (file-path oriented)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relationships</span> <span class="o">=</span> <span class="n">templatepackage</span><span class="o">.</span><span class="n">relationships</span>
    


<span class="c"># ============================================================================</span>
<span class="c"># Shape</span>
<span class="c"># ============================================================================</span>
<span class="c"># Base class for the various types of shape (not including pic, which is a</span>
<span class="c"># distinct element type).  This is actually an abstract class. Adding a Shape</span>
<span class="c"># directly to a slide will likely cause a load error in PowerPoint. Use one</span>
<span class="c"># of the fully fleshed-out subclasses such as PlaceholderText instead or</span>
<span class="c"># modify the element directly to add the required bits for a complete shape.</span>
<span class="c"># ============================================================================</span>

<span class="c">#TECHDEBT: need to account for hierarchy of GroupShape, cSld/spTree is type</span>
<span class="c">#          GroupShape and GroupShape can contain other GroupShape elements in</span>
<span class="c">#          a hierarchy</span>
</div>
<div class="viewcode-block" id="Shape"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.Shape">[docs]</a><span class="k">class</span> <span class="nc">Shape</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span>    <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimalelement</span>
    
    <span class="nd">@property</span>
<div class="viewcode-block" id="Shape.type"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.Shape.type">[docs]</a>    <span class="k">def</span> <span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s">&#39;&#39;&#39;The *type* property needs to be implemented for all subclasses of Shape.&#39;&#39;&#39;</span><span class="p">)</span>
    </div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Shape.minimalelement"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.Shape.minimalelement">[docs]</a>    <span class="k">def</span> <span class="nf">minimalelement</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">sp</span>      <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="n">qname</span><span class="p">(</span><span class="s">&#39;p&#39;</span><span class="p">,</span> <span class="s">&#39;sp&#39;</span><span class="p">))</span>
        <span class="n">nvSpPr</span>  <span class="o">=</span> <span class="n">SubElement</span><span class="p">(</span><span class="n">sp</span>     <span class="p">,</span> <span class="n">qname</span><span class="p">(</span><span class="s">&#39;p&#39;</span><span class="p">,</span> <span class="s">&#39;nvSpPr&#39;</span>  <span class="p">)</span> <span class="p">)</span>
        <span class="n">cNvPr</span>   <span class="o">=</span> <span class="n">SubElement</span><span class="p">(</span><span class="n">nvSpPr</span> <span class="p">,</span> <span class="n">qname</span><span class="p">(</span><span class="s">&#39;p&#39;</span><span class="p">,</span> <span class="s">&#39;cNvPr&#39;</span>   <span class="p">)</span> <span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="s">&#39;None&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">cNvSpPr</span> <span class="o">=</span> <span class="n">SubElement</span><span class="p">(</span><span class="n">nvSpPr</span> <span class="p">,</span> <span class="n">qname</span><span class="p">(</span><span class="s">&#39;p&#39;</span><span class="p">,</span> <span class="s">&#39;cNvSpPr&#39;</span> <span class="p">)</span> <span class="p">)</span>
        <span class="n">spPr</span>    <span class="o">=</span> <span class="n">SubElement</span><span class="p">(</span><span class="n">sp</span>     <span class="p">,</span> <span class="n">qname</span><span class="p">(</span><span class="s">&#39;p&#39;</span><span class="p">,</span> <span class="s">&#39;spPr&#39;</span>    <span class="p">)</span> <span class="p">)</span>
        <span class="k">return</span> <span class="n">sp</span>
    


<span class="c"># ============================================================================</span>
<span class="c"># Slide</span>
<span class="c"># ============================================================================</span>
<span class="c"># Superclass to take care of all base slide functionality.</span>
<span class="c"># ============================================================================</span>
</div></div>
<div class="viewcode-block" id="Slide"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.Slide">[docs]</a><span class="k">class</span> <span class="nc">Slide</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">slides</span><span class="p">,</span> <span class="n">slidelayout</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span>          <span class="o">=</span> <span class="nb">id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">key</span>         <span class="o">=</span> <span class="nb">id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slides</span>      <span class="o">=</span> <span class="n">slides</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span>      <span class="o">=</span> <span class="n">slides</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slidelayout</span> <span class="o">=</span> <span class="n">slidelayout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span>        <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nsmap</span>       <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">nsmap_subset</span><span class="p">([</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="s">&#39;p&#39;</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">])</span>  <span class="c"># keep this here so remaining init can use it</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__id_iter</span>   <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">intsequence</span><span class="p">()</span>                  <span class="c"># this one too ...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimalelement</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shapes</span>      <span class="o">=</span> <span class="n">Shapes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    
    <span class="nd">@property</span>
<div class="viewcode-block" id="Slide.idx"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.Slide.idx">[docs]</a>    <span class="k">def</span> <span class="nf">idx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">slides</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    </div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Slide.images"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.Slide.images">[docs]</a>    <span class="k">def</span> <span class="nf">images</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">shape</span><span class="o">.</span><span class="n">image</span> <span class="k">for</span> <span class="n">shape</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">shapes</span> <span class="k">if</span> <span class="n">shape</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s">&#39;pic&#39;</span><span class="p">]</span>
    
    <span class="c">#TECHDEBT: Not sure about this one, just trying it to get a first package</span>
    <span class="c">#          build working</span></div>
<div class="viewcode-block" id="Slide.setxml"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.Slide.setxml">[docs]</a>    <span class="k">def</span> <span class="nf">setxml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xml</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">xml</span><span class="p">)</span>
    </div>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_nextid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__id_iter</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
    
    <span class="c"># def _append_shape(self, shape):</span>
    <span class="c">#     # assign the new shape an id that&#39;s unique within this Slide</span>
    <span class="c">#     sp_cNvPr = shape.element.xpath(&#39;/p:sp/p:nvSpPr/p:cNvPr&#39;, namespaces=nsmap)[0]</span>
    <span class="c">#     sp_cNvPr.attrib[&#39;id&#39;] = str(self._nextid)</span>
    <span class="c">#     # append shape to spTree element of Slide</span>
    <span class="c">#     sld_spTree = self.element.xpath(&#39;/p:sld/p:cSld/p:spTree&#39;, namespaces=nsmap)[0]</span>
    <span class="c">#     sld_spTree.append(shape.element)</span>
    
    <span class="nd">@property</span>
<div class="viewcode-block" id="Slide.minimalelement"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.Slide.minimalelement">[docs]</a>    <span class="k">def</span> <span class="nf">minimalelement</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">sld</span>        <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="n">qname</span><span class="p">(</span><span class="s">&#39;p&#39;</span><span class="p">,</span> <span class="s">&#39;sld&#39;</span><span class="p">),</span> <span class="n">nsmap</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nsmap</span><span class="p">)</span>
        <span class="n">cSld</span>       <span class="o">=</span> <span class="n">SubElement</span><span class="p">(</span><span class="n">sld</span>       <span class="p">,</span> <span class="n">qname</span><span class="p">(</span><span class="s">&#39;p&#39;</span><span class="p">,</span> <span class="s">&#39;cSld&#39;</span>       <span class="p">)</span> <span class="p">)</span>
        <span class="n">spTree</span>     <span class="o">=</span> <span class="n">SubElement</span><span class="p">(</span><span class="n">cSld</span>      <span class="p">,</span> <span class="n">qname</span><span class="p">(</span><span class="s">&#39;p&#39;</span><span class="p">,</span> <span class="s">&#39;spTree&#39;</span>     <span class="p">)</span> <span class="p">)</span>
        <span class="n">nvGrpSpPr</span>  <span class="o">=</span> <span class="n">SubElement</span><span class="p">(</span><span class="n">spTree</span>    <span class="p">,</span> <span class="n">qname</span><span class="p">(</span><span class="s">&#39;p&#39;</span><span class="p">,</span> <span class="s">&#39;nvGrpSpPr&#39;</span>  <span class="p">)</span> <span class="p">)</span>
        <span class="n">cNvPr</span>      <span class="o">=</span> <span class="n">SubElement</span><span class="p">(</span><span class="n">nvGrpSpPr</span> <span class="p">,</span> <span class="n">qname</span><span class="p">(</span><span class="s">&#39;p&#39;</span><span class="p">,</span> <span class="s">&#39;cNvPr&#39;</span>      <span class="p">)</span> <span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nextid</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">cNvGrpSpPr</span> <span class="o">=</span> <span class="n">SubElement</span><span class="p">(</span><span class="n">nvGrpSpPr</span> <span class="p">,</span> <span class="n">qname</span><span class="p">(</span><span class="s">&#39;p&#39;</span><span class="p">,</span> <span class="s">&#39;cNvGrpSpPr&#39;</span> <span class="p">)</span> <span class="p">)</span>
        <span class="n">nvPr</span>       <span class="o">=</span> <span class="n">SubElement</span><span class="p">(</span><span class="n">nvGrpSpPr</span> <span class="p">,</span> <span class="n">qname</span><span class="p">(</span><span class="s">&#39;p&#39;</span><span class="p">,</span> <span class="s">&#39;nvPr&#39;</span>       <span class="p">)</span> <span class="p">)</span>
        <span class="n">grpSpPr</span>    <span class="o">=</span> <span class="n">SubElement</span><span class="p">(</span><span class="n">spTree</span>    <span class="p">,</span> <span class="n">qname</span><span class="p">(</span><span class="s">&#39;p&#39;</span><span class="p">,</span> <span class="s">&#39;grpSpPr&#39;</span>    <span class="p">)</span> <span class="p">)</span>
        <span class="k">return</span> <span class="n">sld</span>
    </div>
    <span class="nd">@property</span>
<div class="viewcode-block" id="Slide.xmlstring"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.Slide.xmlstring">[docs]</a>    <span class="k">def</span> <span class="nf">xmlstring</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">etree</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="p">,</span> <span class="n">pretty_print</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    


<span class="c"># ============================================================================</span>
<span class="c"># Slides</span>
<span class="c"># ============================================================================</span>
</div></div>
<div class="viewcode-block" id="Slides"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.Slides">[docs]</a><span class="k">class</span> <span class="nc">Slides</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">presentation</span><span class="p">):</span>
        <span class="nb">list</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">presentation</span> <span class="o">=</span> <span class="n">presentation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__id_iter</span>    <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">intsequence</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__dict</span>       <span class="o">=</span> <span class="p">{}</span>
    
<div class="viewcode-block" id="Slides.addslide"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.Slides.addslide">[docs]</a>    <span class="k">def</span> <span class="nf">addslide</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slidelayoutidx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">xml</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="nb">id</span>          <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__id_iter</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
        <span class="n">slidelayout</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">presentation</span><span class="o">.</span><span class="n">slidelayouts</span><span class="o">.</span><span class="n">getitem</span><span class="p">(</span><span class="n">idx</span><span class="o">=</span><span class="n">slidelayoutidx</span><span class="p">)</span>
<span class="c"># ----------------------------------------------------------------------------</span>
<span class="c">#TECHDEBT: This method of assigning the name allows more than one slide to</span>
<span class="c">#          potentially have the same name. Need something a bit more</span>
<span class="c">#          sophisticated if it&#39;s important to avoid that scenario. Note that</span>
<span class="c">#          it&#39;s perhaps somewhat unlikely for that to happen when the</span>
<span class="c">#          presentation is being built by software rather than an end-user</span>
<span class="c">#          who might rearrange and delete slides.</span>
<span class="c"># ----------------------------------------------------------------------------</span>
<span class="c">#REFACTOR: Refactor to use Slides.__nextname and let it use the next unused</span>
<span class="c">#          name. or copy PowerPoint behavior, whatever that is when you delete</span>
<span class="c">#          a slide then add a new one.</span>
        <span class="n">name</span>        <span class="o">=</span> <span class="n">name</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="s">&#39;Slide </span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">presentation</span><span class="o">.</span><span class="n">slides</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">slide</span>       <span class="o">=</span> <span class="n">Slide</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">slidelayout</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
<span class="c"># ----------------------------------------------------------------------------</span>
<span class="c">#TECHDEBT: Not sure exactly how to implement a setxml() method of determining</span>
<span class="c">#          a slide&#39;s content. Would cause a round-tripping challenge unless</span>
<span class="c">#          the XML was parsed and all the properties of the slide set from</span>
<span class="c">#          its contents. Or perhaps it could set a flag that the slide&#39;s</span>
<span class="c">#          contents were static and no properties could be set. Or perhaps</span>
<span class="c">#          the properties we knew how to change would be updated without</span>
<span class="c">#          generating the slide from scratch. So the provided XML would be</span>
<span class="c">#          used as &quot;starting&quot; XML instead of minimalxml(). Opens question</span>
<span class="c">#          of whether XML is updated with each property set call or only</span>
<span class="c">#          generated when the slide XML is rendered.</span>
<span class="c"># ----------------------------------------------------------------------------</span>
        <span class="k">if</span> <span class="n">xml</span><span class="p">:</span>
            <span class="n">slide</span><span class="o">.</span><span class="n">setxml</span><span class="p">(</span><span class="n">xml</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__dict</span><span class="p">[</span><span class="n">slide</span><span class="o">.</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">slide</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">slide</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">slide</span>
    


<span class="c"># ============================================================================</span>
<span class="c"># Shapes</span>
<span class="c"># ============================================================================</span>
<span class="c"># Inherits from list so additional methods and behaviors can be added to</span>
<span class="c"># shapes member of Slide.</span>
<span class="c"># ============================================================================</span>
</div></div>
<div class="viewcode-block" id="Shapes"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.Shapes">[docs]</a><span class="k">class</span> <span class="nc">Shapes</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="nb">list</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
    
<div class="viewcode-block" id="Shapes.append"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.Shapes.append">[docs]</a>    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">Shape</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;Slide.shapes.append() called with incorrect type, (expected Shape, got </span><span class="si">%s</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="n">shape</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
        <span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slide</span><span class="o">.</span><span class="n">_append_shape</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
    


<span class="c"># ============================================================================</span>
<span class="c"># TemplatePartCollection</span>
<span class="c"># ============================================================================</span>
</div></div>
<div class="viewcode-block" id="TemplatePartCollection"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.TemplatePartCollection">[docs]</a><span class="k">class</span> <span class="nc">TemplatePartCollection</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">list</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__dict</span> <span class="o">=</span> <span class="p">{}</span>
    
<div class="viewcode-block" id="TemplatePartCollection.additem"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.TemplatePartCollection.additem">[docs]</a>    <span class="k">def</span> <span class="nf">additem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">path</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="n">part</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">memberclass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">part</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">part</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">part</span>
    
    <span class="c"># Can implement a __contains__(self, value) method if anyone needs to test</span>
    <span class="c"># whether something is already in the collection.</span></div>
<div class="viewcode-block" id="TemplatePartCollection.getitem"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.TemplatePartCollection.getitem">[docs]</a>    <span class="k">def</span> <span class="nf">getitem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">path</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">path</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s">&quot;&quot;&quot;getitem() lookup in </span><span class="si">%s</span><span class="s"> failed with key &#39;</span><span class="si">%s</span><span class="s">&#39;&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">idx</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&#39;&#39;&#39;</span><span class="si">%s</span><span class="s">.getitem() called without a lookup key (either path or idx)&#39;&#39;&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
    


<span class="c"># ============================================================================</span>
<span class="c"># Images</span>
<span class="c"># ============================================================================</span>
<span class="c"># Collection of all the images used in this presentation. Each image is</span>
<span class="c"># stored only once, regardless of how often it is used.</span>
<span class="c"># ============================================================================</span>
</div></div>
<div class="viewcode-block" id="Images"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.Images">[docs]</a><span class="k">class</span> <span class="nc">Images</span><span class="p">(</span><span class="n">TemplatePartCollection</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">TemplatePartCollection</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">memberclass</span> <span class="o">=</span> <span class="n">Image</span>
    


<span class="c"># ============================================================================</span>
<span class="c"># SlideLayouts</span>
<span class="c"># ============================================================================</span>
</div>
<div class="viewcode-block" id="SlideLayouts"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.SlideLayouts">[docs]</a><span class="k">class</span> <span class="nc">SlideLayouts</span><span class="p">(</span><span class="n">TemplatePartCollection</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">TemplatePartCollection</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">memberclass</span> <span class="o">=</span> <span class="n">SlideLayout</span>
    


<span class="c"># ============================================================================</span>
<span class="c"># SlideMasters</span>
<span class="c"># ============================================================================</span>
</div>
<div class="viewcode-block" id="SlideMasters"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.SlideMasters">[docs]</a><span class="k">class</span> <span class="nc">SlideMasters</span><span class="p">(</span><span class="n">TemplatePartCollection</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">TemplatePartCollection</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">memberclass</span> <span class="o">=</span> <span class="n">SlideMaster</span>
    


<span class="c"># ============================================================================</span>
<span class="c"># Themes</span>
<span class="c"># ============================================================================</span>
</div>
<div class="viewcode-block" id="Themes"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.Themes">[docs]</a><span class="k">class</span> <span class="nc">Themes</span><span class="p">(</span><span class="n">TemplatePartCollection</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">TemplatePartCollection</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">memberclass</span> <span class="o">=</span> <span class="n">Theme</span>
    


<span class="c"># ============================================================================</span>
<span class="c"># TemplatePart</span>
<span class="c"># ============================================================================</span>
<span class="c">#REFACTOR: Needs some cleanup here to account for differences between single</span>
<span class="c">#          parts and those that are part of a collection (group parts?). The</span>
<span class="c">#          inheritance of properties is too distributed between super class</span>
<span class="c">#          and subclass, and it&#39;s weird that they have to keep track of their</span>
<span class="c">#          own cardinality. Using the modifiers &quot;scalar&quot; vs. &quot;vector&quot; might be</span>
<span class="c">#          something to use in elaborating the class hierarchy by one level</span>
<span class="c">#          e.g. ScalarTemplatePart and VectorTemplatePart. Also consider</span>
<span class="c">#          single vs group, scalar vs tuple, scalar vs list, scalar vs array,</span>
<span class="c">#          (plain old) part vs collectionPart. That last one is interesting</span>
<span class="c">#          because collection parts need everything a regular part has and</span>
<span class="c">#          just need to add a bit more. Also &#39;collection&#39; is what they&#39;re a</span>
<span class="c">#          part of. SOLD!</span>
</div>
<div class="viewcode-block" id="TemplatePart"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.TemplatePart">[docs]</a><span class="k">class</span> <span class="nc">TemplatePart</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span>        <span class="o">=</span> <span class="n">path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">key</span>         <span class="o">=</span> <span class="n">path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cardinality</span> <span class="o">=</span> <span class="s">&#39;multiple&#39;</span>
    
    <span class="nd">@property</span>
<div class="viewcode-block" id="TemplatePart.idx"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.TemplatePart.idx">[docs]</a>    <span class="k">def</span> <span class="nf">idx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cardinality</span> <span class="o">==</span> <span class="s">&#39;multiple&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s">&#39;&#39;&#39;TemplatePart.idx is not defined for parts with cardinality!=&#39;multiple&#39;. Called on class &#39;</span><span class="si">%s</span><span class="s">&#39;.&#39;&#39;&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
    


<span class="c"># ============================================================================</span>
<span class="c"># Image</span>
<span class="c"># ============================================================================</span>
</div></div>
<div class="viewcode-block" id="Image"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.Image">[docs]</a><span class="k">class</span> <span class="nc">Image</span><span class="p">(</span><span class="n">TemplatePart</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="n">TemplatePart</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span>       <span class="o">=</span> <span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slidemasters</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slidelayouts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slides</span>       <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">themes</span>       <span class="o">=</span> <span class="p">[]</span>
    


<span class="c"># ============================================================================</span>
<span class="c"># HandoutMaster</span>
<span class="c"># ============================================================================</span>
</div>
<div class="viewcode-block" id="HandoutMaster"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.HandoutMaster">[docs]</a><span class="k">class</span> <span class="nc">HandoutMaster</span><span class="p">(</span><span class="n">TemplatePart</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="n">TemplatePart</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cardinality</span> <span class="o">=</span> <span class="s">&#39;single&#39;</span>
    


<span class="c"># ============================================================================</span>
<span class="c"># NotesMaster</span>
<span class="c"># ============================================================================</span>
</div>
<div class="viewcode-block" id="NotesMaster"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.NotesMaster">[docs]</a><span class="k">class</span> <span class="nc">NotesMaster</span><span class="p">(</span><span class="n">TemplatePart</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="n">TemplatePart</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cardinality</span> <span class="o">=</span> <span class="s">&#39;single&#39;</span>
    


<span class="c"># ============================================================================</span>
<span class="c"># PresProps</span>
<span class="c"># ============================================================================</span>
</div>
<div class="viewcode-block" id="PresProps"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.PresProps">[docs]</a><span class="k">class</span> <span class="nc">PresProps</span><span class="p">(</span><span class="n">TemplatePart</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="n">TemplatePart</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cardinality</span> <span class="o">=</span> <span class="s">&#39;single&#39;</span>
    


<span class="c"># ============================================================================</span>
<span class="c"># SlideLayout</span>
<span class="c"># ============================================================================</span>
</div>
<div class="viewcode-block" id="SlideLayout"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.SlideLayout">[docs]</a><span class="k">class</span> <span class="nc">SlideLayout</span><span class="p">(</span><span class="n">TemplatePart</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="n">TemplatePart</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span>      <span class="o">=</span> <span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slidemaster</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">images</span>      <span class="o">=</span> <span class="p">[]</span>
    


<span class="c"># ============================================================================</span>
<span class="c"># SlideMaster</span>
<span class="c"># ============================================================================</span>
<span class="c"># TECHNOTE: In the Microsoft API, Master is a general type that all of</span>
<span class="c"># SlideMaster, SlideLayout (CustomLayout), HandoutMaster, and NotesMaster</span>
<span class="c"># inherit from. So might look into why that is and consider refactoring the</span>
<span class="c"># various masters a bit later.</span>
<span class="c"># ============================================================================</span>
</div>
<div class="viewcode-block" id="SlideMaster"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.SlideMaster">[docs]</a><span class="k">class</span> <span class="nc">SlideMaster</span><span class="p">(</span><span class="n">TemplatePart</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="n">TemplatePart</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span>       <span class="o">=</span> <span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element</span>      <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">.</span><span class="n">getroot</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theme</span>        <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slidelayouts</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">images</span>       <span class="o">=</span> <span class="p">[]</span>
    


<span class="c"># ============================================================================</span>
<span class="c"># TableStyles</span>
<span class="c"># ============================================================================</span>
</div>
<div class="viewcode-block" id="TableStyles"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.TableStyles">[docs]</a><span class="k">class</span> <span class="nc">TableStyles</span><span class="p">(</span><span class="n">TemplatePart</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="n">TemplatePart</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cardinality</span> <span class="o">=</span> <span class="s">&#39;single&#39;</span>
    


<span class="c"># ============================================================================</span>
<span class="c"># Theme</span>
<span class="c"># ============================================================================</span>
</div>
<div class="viewcode-block" id="Theme"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.Theme">[docs]</a><span class="k">class</span> <span class="nc">Theme</span><span class="p">(</span><span class="n">TemplatePart</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="n">TemplatePart</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">images</span> <span class="o">=</span> <span class="p">[]</span>
    


<span class="c"># ============================================================================</span>
<span class="c"># ViewProps</span>
<span class="c"># ============================================================================</span>
</div>
<div class="viewcode-block" id="ViewProps"><a class="viewcode-back" href="../../pptx.html#pptx.presentation.ViewProps">[docs]</a><span class="k">class</span> <span class="nc">ViewProps</span><span class="p">(</span><span class="n">TemplatePart</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="n">TemplatePart</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cardinality</span> <span class="o">=</span> <span class="s">&#39;single&#39;</span>
    


<span class="c"># # ============================================================================</span>
<span class="c"># # PlaceholderText</span>
<span class="c"># # ============================================================================</span>
<span class="c"># # Shape that holds text to be displayed in a placeholder specified by the</span>
<span class="c"># # slide layout.</span>
<span class="c"># #     The placeholder_type provided must be one of ST_PlaceholderType defined</span>
<span class="c"># # in the PresentationML schema.</span>
<span class="c"># #     The string supplied as the text parameter may contain carriage returns</span>
<span class="c"># # (&#39;\r&#39;) and or line feeds (&#39;\n&#39;). Carriage returns will cause a new run to</span>
<span class="c"># # be created with a break (&lt;a:br/&gt;) intervening between it and the prior run.</span>
<span class="c"># # Line feeds will cause a new paragraph to be created to contain the text</span>
<span class="c"># # that follows the line feed.</span>
<span class="c"># #     The index parameter is important for matching up the text with the</span>
<span class="c"># # right placeholder. I don&#39;t fully understand the logic used, but in one</span>
<span class="c"># # pptx file I&#39;ve seen the &lt;p:ph&gt; idx attribute matched with that of the</span>
<span class="c"># # proper placeholder. The default is 0 and that seems to match the title</span>
<span class="c"># # placeholder.</span>
<span class="c"># # ============================================================================</span>
<span class="c">#</span>
<span class="c"># class PlaceholderText(Shape):</span>
<span class="c">#</span>
<span class="c">#     def __init__(self, name, placeholder_type, text, placeholder_index=None):</span>
<span class="c">#         if placeholder_type not in placeholder_types:</span>
<span class="c">#             raise TypeError(&quot;placeholder_type must be one of %s, got &#39;%s&#39;.&quot; % (placeholder_types, placeholder_type))</span>
<span class="c">#         Shape.__init__(self, name)</span>
<span class="c">#         self.placeholder_type  = placeholder_type</span>
<span class="c">#         self.placeholder_index = placeholder_index</span>
<span class="c">#         self.text = text</span>
<span class="c">#</span>
<span class="c">#         # locate nodes we need to have handy (these are all required elements so we&#39;re assured they&#39;re present)</span>
<span class="c">#         sp      = self.element</span>
<span class="c">#         nvSpPr  = sp.find(qname(&#39;p&#39;, &#39;nvSpPr&#39;))</span>
<span class="c">#         spPr    = sp.find(qname(&#39;p&#39;, &#39;spPr&#39;))</span>
<span class="c">#         cNvSpPr = nvSpPr.find(qname(&#39;p&#39;, &#39;cNvSpPr&#39;))</span>
<span class="c">#</span>
<span class="c">#         # add shape lock to prevent grouping the placeholder element with others</span>
<span class="c">#         node = cNvSpPr.find(qname(&#39;a&#39;, &#39;spLocks&#39;))</span>
<span class="c">#         spLocks = node if node else SubElement(cNvSpPr, qname(&#39;a&#39;, &#39;spLocks&#39;))</span>
<span class="c">#         spLocks.attrib[&#39;noGrp&#39;] = &#39;true&#39;</span>
<span class="c">#</span>
<span class="c">#         # add placeholder type so text can find its home on slide layout</span>
<span class="c">#         node = nvSpPr.find(qname(&#39;p&#39;, &#39;nvPr&#39;))</span>
<span class="c">#         nvPr = node if node else SubElement(nvSpPr, qname(&#39;p&#39;, &#39;nvPr&#39;))</span>
<span class="c">#         node = nvPr.find(qname(&#39;p&#39;, &#39;ph&#39;))</span>
<span class="c">#         ph   = node if node else SubElement(nvPr, qname(&#39;p&#39;, &#39;ph&#39;))</span>
<span class="c">#         ph.attrib[&#39;type&#39;] = placeholder_type</span>
<span class="c">#         if placeholder_index:</span>
<span class="c">#             ph.attrib[&#39;idx&#39;] = str(placeholder_index)</span>
<span class="c">#</span>
<span class="c">#         # add txBody to hold text</span>
<span class="c">#         txBody = sp.find(qname(&#39;p&#39;, &#39;txBody&#39;))</span>
<span class="c">#         if not node:</span>
<span class="c">#             txBody = Element(qname(&#39;p&#39;, &#39;txBody&#39;))</span>
<span class="c">#             sp.insert(sp.index(spPr)+1, txBody)</span>
<span class="c">#         bodyPr = txBody.find(qname(&#39;a&#39;, &#39;bodyPr&#39;))</span>
<span class="c">#         if not bodyPr:</span>
<span class="c">#             bodyPr = Element(qname(&#39;a&#39;, &#39;bodyPr&#39;))</span>
<span class="c">#             txBody.insert(0, bodyPr)</span>
<span class="c">#</span>
<span class="c">#         # get rid of any text that might be there already</span>
<span class="c">#         del txBody[1:]</span>
<span class="c">#</span>
<span class="c">#         # insert the provided text</span>
<span class="c">#         lines = text.split(&#39;\n&#39;)</span>
<span class="c">#         for line in lines:</span>
<span class="c">#             p = SubElement(txBody, qname(&#39;a&#39;, &#39;p&#39;))</span>
<span class="c">#             runs = line.split(&#39;\r&#39;)</span>
<span class="c">#             for run in runs:</span>
<span class="c">#                 br = SubElement(p, qname(&#39;a&#39;, &#39;br&#39;)) if runs.index(run) &gt; 0 else None</span>
<span class="c">#                 r = SubElement(p, qname(&#39;a&#39;, &#39;r&#39;))</span>
<span class="c">#                 t = SubElement(r, qname(&#39;a&#39;, &#39;t&#39;))</span>
<span class="c">#                 t.text = run</span>
<span class="c">#</span>
<span class="c">#</span>
<span class="c">#     @property</span>
<span class="c">#     def minimalelement(self):</span>
<span class="c">#         sp      = Element(qname(&#39;p&#39;, &#39;sp&#39;))</span>
<span class="c">#         nvSpPr  = SubElement(sp     , qname(&#39;p&#39;, &#39;nvSpPr&#39;  ) )</span>
<span class="c">#         cNvPr   = SubElement(nvSpPr , qname(&#39;p&#39;, &#39;cNvPr&#39;   ) , id=&#39;None&#39;, name=self.name)</span>
<span class="c">#         cNvSpPr = SubElement(nvSpPr , qname(&#39;p&#39;, &#39;cNvSpPr&#39; ) )</span>
<span class="c">#         spPr    = SubElement(sp     , qname(&#39;p&#39;, &#39;spPr&#39;    ) )</span>
<span class="c">#         return sp</span>
</pre></div></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../index.html">python-pptx 0.1.0 documentation</a> &raquo;</li>
          <li><a href="../index.html" >Module code</a> &raquo;</li>
          <li><a href="../pptx.html" >pptx</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Steve Canny.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>